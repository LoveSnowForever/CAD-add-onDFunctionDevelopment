### 开发需求：

主要扩展命令功能三点实现:

1. 面料量的计算

2. 木料量的计算

3. 泡沫量的计算

这三种的输入都是以在CAD中框选的区域作为输入数据来源，输出目前后两种都是以excel表格为输出介质，第一个面料的计算会设计到c\#生成命令绘制成相应的图形之后，并且生成excel表格

由于对于客户的需求是在不断变化的，也就是说他们要生产的沙发模型不是固定的，这是一个很大的难点，所以我们每次针对的模型都是变化的

目前我们现针对最简单的90°（也就是直角的沙发）的进行命令的开发，分别要做的事计算面料和木料  
下面的输出解析以大中华木料的实例为主

##### 第一 . 木料：

（可能会存在斜口，也就是在角度区域会有分叉的部分）  
如 ： sheet2 中 V88-1B 代表一个模块：

![](/assets/捕获.PNG)  
此图为图1  
上面对应着在成都BOOM GC.CLUB中的  
![](/assets/1.PNG)  
此图为图2  
需要得到的信息

##### （1）沙发的长度 -- 1380（读取） 在图一中单元格对应的就是A6

##### \(2\) 木料的规格 -- 由图三读取,列出所有的以\#结尾的

![](/assets/2.PNG)  
  此图为图三  
  可以添加和删除每一个

##### \(3\) 木料的实际长度

由三角公式得出 diff = 1/cos \(\(90-角度\)\*PI\)/180 得出误差差值  
再由公式 读取的沙发长度（1380）-\(1\*TAN\(\(90-角度\)\*PI\(\)/180\)\)-1.3-0.4\*diff

##### 第二.海绵

![](/assets/3.PNG)  
此图为图四  
\(1\)位置变量 ：  
座\(seat\) ;  
上背\(upBack\) ;  
下背\(downBack\) ;  
背顶\(backTop\) ;  
坐前上\(seatFrontUp\) ;  
坐前下\(seatFrontDown\) ;  
坐侧 \(seatSide\) ;  
背侧 \(backSide\) ;  
背后 \(back\);  
扶手前 \(railFront\) ;

\(2\) 各位置属性  
密度 \(density\) ;  
厚度 \(thickness\) ;  
宽度 \(width\) ;  
长度 \(length\) ;  
件数 \(pcs\) ;  
备注 \(note\) ;

\(3\) 解释  
海绵的excel 列表为图四  
其中位置列变量如\(1\), 其中每一个位置的属性如\(2\), 可以用二维数组装  
对位置的设计：

  
其中在上述表格中，位置不一定全部都有，但都要显示出来，以密度的属性值为不为空作为标准，若为空则代表这个位置不存在，在最后生成表格的时候就不显示这个位置及其属性值  
对属性的设计，密度，厚度，宽度和件数以及备注都是人为输入，主要是长度的计算会设计框选cad 图层及其相关操作

